name: Rclone Workflow Download and Upload

on:
  push:
    branches:
      - main

jobs:
  rclone-job-D-U:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Install rclone
      run: |
        curl https://rclone.org/install.sh | sudo bash

    - name: Create rclone.conf
      run: |
        mkdir -p ~/.config/rclone
        cat <<EOF > ~/.config/rclone/rclone.conf
        [w1928440]
        type = drive
        scope = drive
        token = {"access_token":"ya29.a0AXooCgvBuHaABrOcOFd6XPc7_Jobu7gxIuEclzVoEAjYegVzBlJhuZOdbkQsCba-r2hsrYYELTRl9k1JiC7XJD2zzrmOqO3xWu7t3ne4pbS7uOXsj_4CuTHL0_Zzk3vIJyynmlbHoO71uHJMAcYHi-vFodDsB92N5aD_aCgYKAfgSARESFQHGX2MilerpDwLXbqWI5ph4oidGMg0171","token_type":"Bearer","refresh_token":"1//0gkoI7p7FtaZjCgYIARAAGBASNwF-L9IrrGIqlVBs3630G3I-oUQ7Ic6LyCh152g6USjw7aYnFRdS4q8N-ClGktC3tE85TILngEU","expiry":"2024-07-04T23:03:40.7952531+05:30"}
        team_drive = 
        EOF

    - name: Download file from URL
      run: |
        curl -o /tmp/jellyfin_backup.zip https://download.vflix.xyz/jellyfin_backup.zip

    - name: Upload file to rclone mount
      run: |
        rclone copy /tmp/jellyfin_backup.zip w1928440:bkp --drive-chunk-size 256M --retries 3 --low-level-retries 10
